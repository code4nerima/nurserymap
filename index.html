<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta http-equiv="content-language" content="ja">
<title>練馬たぬきマップ</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
   integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
   crossorigin=""/>
<!-- Make sure you put this AFTER Leaflet's CSS -->
<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
crossorigin=""></script>

<script language="javascript" src="custom.js"></script>
<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<style>
html, body  {
	width: 100%;
	height: 100%;
	padding: 0px;
	margin: 0px;
}
#map {
	width: 100%;
	height: 100%;
}

.info {
    padding: 6px 8px;
    font: 14px/16px Arial, Helvetica, sans-serif;
    background: white;
    background: rgba(255,255,255,0.8);
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    border-radius: 5px;
}
.info h4 {
    margin: 0 0 5px;
    color: #777;
}

</style>
</head>
<body>
<div id="map"></div>
<script>

var latlng = onInitialLatLng() ;

var map = L.map('map').setView(latlng, 13);

var mapLink = '<a href="http://openstreetmap.org">OpenStreetMap</a>';

L.tileLayer(
	'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
	{
		attribution: 'Map data &copy; ' + mapLink,
		maxZoom: 18
	}
).addTo(map);

onCreate(map) ;
    
var markerIcon = onCreateMarkerIcon();

$.getJSON(onRequireAreaBorder(), function(data) {
    L.geoJson(data).addTo(map);
});

$.getJSON('./data/data.geojson', function(data) {
    L.geoJson(data, {
    	pointToLayer: function(geoJsonPoint, latlng) {
	    	return L.marker(latlng, {icon: markerIcon}).addTo(map)
		},
		onEachFeature: function(feature, layer) {
			onCraeteMarkerPopup(feature, layer) ;

			layer.on({
        		mouseover: function(e){
					onMarkerMouseOver(e);
				},
        		mouseout: function(e){
					onMarkerMouseOut(e);
				},
        		click: function(e){
					onMarkerClick(e);
				}
    		});
		}
    }).addTo(map);
});

var popup = L.popup();

function onMapClick(e) {
	//popup.setLatLng(e.latlng).setContent("You clicked the map at " + e.latlng.toString()).openOn(map);
}

map.on('click', onMapClick);

var info = L.control();

info.onAdd = function (map) {
    this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
    this.update();
    return this._div;
};

// method that we will use to update the control based on feature properties passed
info.update = function (props) {
    this._div.innerHTML = '<strong>練馬たぬきマップ</strong>';
};

info.addTo(map);

</script>
</body>
</html>